# WinRTWrapper
A wrapper source generator for WinRT

[![Issues](https://img.shields.io/github/issues/wherewhere/WinRTWrapper.svg?label=Issues&style=flat-square)](https://github.com/wherewhere/WinRTWrapper/issues "Issues")
[![Stargazers](https://img.shields.io/github/stars/wherewhere/WinRTWrapper.svg?label=Stars&style=flat-square)](https://github.com/wherewhere/WinRTWrapper/stargazers "Stargazers")

## Support Language
- C# ISO-2 or later

## How to use
1. Add the NuGet package `WinRTWrapper` to your project.
2. Find a class or interface that you want to wrap for WinRT. For example, let's say you have a simple class like this:
   ```cs
   public sealed class Simple
   {
       public int Property { get; set; }
       public int Method() => Property;
       public Task MethodAsync() => Task.CompletedTask;
       public event EventHandler<int>? Event;
   }
   ```
3. Add the `GenerateWinRTWrapper` attribute to your class or interface that you want to wrap.
   ```cs
   [GenerateWinRTWrapper(typeof(Simple))]
   public sealed partial class SimpleWrapper;
   ```
4. The source generator will automatically generate a WinRT wrapper for the specified class or interface. You can then use this wrapper in your WinRT applications.
   ```cs
   // <auto-generated/>
   #pragma warning disable

   /// <inheritdoc cref="T:Simple"/>
   public static partial class SimpleWrapper
   {
       /// <summary>
       /// The target <see cref="T:Simple"/> object of the wrapper.
       /// </summary>
       private readonly global::WinRTWrapper.Test.Simple target;

       /// <summary>
       /// Initializes a new instance of the <see cref="T:SimpleWrapper"/> class with the specified target <see cref="T:Simple"/> object.
       /// </summary>
       /// <param name="target">The target <see cref="T:Simple"/> object.</param>
       internal SimpleWrapper(global::WinRTWrapper.Test.Simple target)
       {
           this.target = target;
       }

       /// <inheritdoc cref="P:Simple.Property"/>
       public int Property
       {
           get
           {
               return this.target.Property;
           }
        
           set
           {
               this.target.Property = value;
           }
       }

       /// <inheritdoc cref="M:Simple.Method"/>
       public int Method()
       {
           return this.target.Method();
       }

       /// <inheritdoc cref="M:Simple.MethodAsync"/>
       public static global::Windows.Foundation.IAsyncAction MethodAsync()
       {
           return global::System.WindowsRuntimeSystemExtensions.AsAsyncAction(this.target.MethodAsync());
       }

       /// <inheritdoc cref="E:Simple.Event"/>
       public event global::System.EventHandler<int> Event
       {
           add
           {
               this.target.Event += value;
           }
           remove
           {
               this.target.Event -= value;
           }
       }
   }
   ```